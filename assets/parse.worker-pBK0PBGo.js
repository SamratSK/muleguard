const c=self,d=r=>{const o=[];let t="",e=!1;for(let s=0;s<r.length;s+=1){const n=r[s];if(n==='"'){e&&r[s+1]==='"'?(t+='"',s+=1):e=!e;continue}if(n===","&&!e){o.push(t),t="";continue}t+=n}return o.push(t),o};c.onmessage=r=>{const{header:o,lines:t}=r.data;try{const e=d(o).map(a=>a.trim()),s=e.indexOf("sender_id"),n=e.indexOf("receiver_id"),f=e.indexOf("transaction_id"),m=e.indexOf("amount"),l=e.indexOf("timestamp");if(s===-1||n===-1){c.postMessage({rows:[]});return}const u=t.filter(Boolean).map(a=>{const i=d(a).map(p=>p.trim());return{transaction_id:i[f]??"",sender_id:i[s]??"",receiver_id:i[n]??"",amount:i[m]??"",timestamp:i[l]??""}});c.postMessage({rows:u})}catch(e){c.postMessage({error:e instanceof Error?e.message:"Parse failed",rows:[]})}};
