const t=self;t.onmessage=o=>{const{header:a,lines:d}=o.data;try{const e=a.split(",").map(r=>r.trim()),n=e.indexOf("sender_id"),i=e.indexOf("receiver_id"),c=e.indexOf("transaction_id"),m=e.indexOf("amount"),x=e.indexOf("timestamp");if(n===-1||i===-1){t.postMessage({rows:[]});return}const f=d.filter(Boolean).map(r=>{const s=r.split(",").map(p=>p.trim());return{transaction_id:s[c]??"",sender_id:s[n]??"",receiver_id:s[i]??"",amount:s[m]??"",timestamp:s[x]??""}});t.postMessage({rows:f})}catch(e){t.postMessage({error:e instanceof Error?e.message:"Parse failed",rows:[]})}};
